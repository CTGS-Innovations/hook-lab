{
  "_comment": "Test 5: Conditional agent - only runs if gate file exists",
  "_theory": "Can we make agent conditional via command output?",
  "_problem": "Hooks in same array run in PARALLEL - can't chain commandâ†’agent",
  "_solution": "Use separate hook event OR file from PREVIOUS event",
  "hooks": {
    "UserPromptSubmit": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "/home/corey/hook-lab/hooks/gate-checker.sh",
            "timeout": 2
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "cat /home/corey/hook-lab/results/work-gate 2>/dev/null && echo '{\"hookSpecificOutput\": {\"additionalContext\": \"TRIGGER_AGENT\"}}' || true",
            "timeout": 2
          },
          {
            "type": "agent",
            "prompt": "Check if /home/corey/hook-lab/results/work-gate exists. If yes, read /home/corey/hook-lab/results/pending-task.json and execute it. If no, return immediately.",
            "timeout": 30,
            "model": "haiku"
          }
        ]
      }
    ]
  }
}
